<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>INCAR</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/css/magnific-popup.css">
    <link rel="stylesheet" href="/css/aos.css">
    <link rel="stylesheet" href="/css/ionicons.min.css">
    <link rel="stylesheet" href="/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/css/jquery.timepicker.css">
    <link rel="stylesheet" href="/css/flaticon.css">
    <link rel="stylesheet" href="/css/icomoon.css">
    <link rel="stylesheet" href="/css/style.css"> <!--css 원본파일-->
    <link rel="stylesheet" href="/css/jihee.css"> <!--지희-->
    <link rel="stylesheet" href="/css/custom_ha.css"> <!--현아언니-->
    <style>
        .star_rating .star,
        .star_rating .star.on {
            width: 38.5px;
            height: 38.5px;
        }

        #review_detail_subject {
            width: 340px;
            text-align: left;
            margin-bottom: 0px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .review_detail_content>.re_right li {
            list-style: none;
            text-align: left;
        }
    </style>
</head>
<body>
<!-- --------nav 상단바 start -->
<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light">
    <div class="container">
        <a class="navbar-brand2" th:href="@{/}" style="color: #001F3F;">ING<span style="color: #00CED1;">Car</span></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
                aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span> Menu
        </button>
        <div class="collapse navbar-collapse" id="ftco-nav" style="white-space: nowrap; width: 80%; height: 100%;">
            <ul class="navbar-nav">
                <li class="nav-item"><a th:href="@{/car_registration}" class="nav-link" id="nav-link4">내차팔기</a></li>
                <li class="nav-item"><a th:href="@{/car_list}" class="nav-link" id="nav-link4">내차사기</a></li>
                <li class="nav-item"><a th:href="@{/review_main}" class="nav-link" id="nav-link4">후기게시판</a></li>
                <li class="nav-item"><a th:href="@{/inform}" class="nav-link" id="nav-link4">공지게시판</a></li>
            </ul>
        </div>
        <div class="collapse navbar-collapse" id="ftco-nav">
            <ul class="navbar-nav ml-auto" style="white-space: nowrap;">
                <li class="nav-item" th:if="${session.user_session == null}">
                    <a th:href="@{/loginPage}" class="nav-link5">login</a>
                </li>
                <li class="nav-item" th:if="${session.user_session != null}">
                    <a th:href="@{/logout}" class="nav-link5">logout</a>
                </li>
                <li class="nav-item"> <a th:href="@{/mypage}" class="nav-link5">Mypage </a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- --------nav 상단바 end---------------------------- -->
<section class="hero-wrap hero-wrap-2 js-fullheight" style="background-image: url('/images/bg_3.jpg');"
         data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-end justify-content-start">
            <div class="col-md-9 ftco-animate pb-5">
                <p class="breadcrumbs"><span class="mr-2"><a th:href="@{/}">Home <i
                        class="ion-ios-arrow-forward"></i></a></span> <span>Review_Board <i
                        class="ion-ios-arrow-forward"></i></span>
                </p>
                <h1 class="mb-3 bread">후기 게시판</h1>
            </div>
        </div>
    </div>
</section>

<section class="ftco-section">
    <div class="container">
        <div class="row d-flex justify-content-center"  >
            <div class="col-md-12 text-center d-flex ftco-animate">
                <div class="blog-entry justify-content-end mb-md-5">
                    <div class="block-20 img" style='height:500px; width:1100px'>
                        <div class='review_detail_area' th:each="reviewdetail : ${result_reviewdetail}">

                            <!-- 숨겨진 필드에 logId 값을 설정 -->
                            <input type="hidden" th:attr="value=${reviewdetail.getLog_id()}" id="logId"/>
                            <!--       주석처럼 보일 수 있지만, 실제로는 Thymeleaf가 이를 해석하여 서버 사이드 변수를 클라이언트 사이드 JavaScript 코드로 전달하는 방법 -->
                            <script th:inline="javascript">
                                let currentUserId = /*[[${user_session.user_id}]]*/ 'defaultUserId'; // 사용자 ID
                            </script>

                            <div class='review_detail_img_area'>
                                <img th:src="@{|/images/${reviewdetail.getModel()}(1).jpg|}" alt="" class='review_detail_img' style='border-radius: 4px;'>
                            </div>
                            <div class="review_detail_header">
                                <div class='re_left'>
                                    <h5 id="review_detail_subject" th:text="${reviewdetail.board_subject}">제목</h5>
                                    <div class='review_detail_writer_info'>
                                        <p th:text="${reviewdetail.buyer}">구매자</p>
                                        <p th:text="${#dates.format(reviewdetail.board_updatedate, 'yyyy-MM-dd')}">yyyy.mm.dd</p>
                                        <p>조회 <span th:text="${reviewdetail.board_count}">2</span></p>
                                    </div>
                                </div>
                                <div class='re_right'>
                                    <div class="star_rating" style='height:60px; padding-left:20px'>
                                        <span th:each="i : ${#numbers.sequence(1, reviewdetail.getBoard_star())}" class="star on" th:attr="data-value=${i}"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="review_detail_content">
                                <div class='re_left'>
                                    <p class="review_detail_text" th:text="${reviewdetail.getBoard_content()}">
                                        후기 상세 내용
                                    </p>
                                </div>
                                <div class='re_right'>
                                    <ul>
                                        <li>판매자 : <span th:text="${reviewdetail.seller}">판매자</span></li>
                                        <li>모델 : <span th:text="${reviewdetail.model}">차량모델</span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- 수정 및 삭제 버튼을 조건부로 표시 -->
                        <div class='review_button_area' th:if="${tf_IsOwner}">
                            <button id='review_button' onclick="" class='review_btn_del'>삭제</button>
                            <button id='review_button' onclick="" class='review_btn_rep'>수정</button>
                        </div>
                    </div>
                    <!-- 댓글 리스트 -->
                    <div id="comments-section" class="container mb-5 mt-5">
                        <div id="comments-list"></div>
                    </div>
                    <!-- 댓글 작성 창 시작 -->
                    <div class="bg-light p-2">
                        <div class="d-flex flex-row align-items-start">
                            <img class="rounded-circle" src="/images/icon_car_role.png" width="40" alt="">
                            <label for="commentwritearea"><textarea id="commentwritearea" class="form-control ml-1 shadow-none textarea" placeholder="댓글을 남겨주세요." style="font-size: 14px;" data-comment-type="comment"></textarea></label>
                        </div>
                        <div class="mt-2 text-right">
                            <button class="btn btn-primary btn-sm shadow-none" type="button" onclick="addComment(null)">Post comment</button>
                        </div>
                    </div>
                    <!-- 댓글 작성 창 끝 -->

                    <!--삭제 버튼 클릭시 모달 팝업-->
                    <div class="modal_del">
                        <div class="modal_popup_del">
                            <!-- 삭제 버튼 클릭시에만 보여져야함 -->
                            <form action="#" class='review_del_form' method='post'
                                  onsubmit="handleDeleteReview(event)">

                                <span>삭제를 계속 진행하실 경우, </span><br>
                                <span>계정 비밀번호를 입력하세요.</span><br><br>
                                비밀번호 : <input type="password" id="delete_pwd" name="delete_pwd">
                                <!-- 비밀번호 일치할 시에만 삭제되도록 해야함 -->
                                <input type="submit" value="확인">
                                <input type="button" value="닫기" class="del_close_btn">
                            </form>
                        </div>
                    </div>

                    <!-- 후기 수정 모달창 -->
                    <div class="modal" id="editModal">
                        <div class="modal_popup">
                            <!-- 수정 버튼 클릭시에만 보여져야함 -->
                            <form action="#" method="post" name='reviewform' onsubmit="submitEditReviewForm(event)" class='review_rep_form' id="editReviewForm">

                                <!-- 숨겨진 필드에 logId 값을 설정 -->
                                <input type="hidden" id="logId" name="log_id" value="/*[[${log_id}]]*/" />

                                <table>
                                    <tr>
                                        <td>
                                            <h4 style='margin-top:10px; margin-bottom:10px' >후기 수정</h4>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td id='review_re'>
                                            <div class="star_rating">
                                                <span class="star on" data-value="1"> </span>
                                                <span class="star on" data-value="2"> </span>
                                                <span class="star" data-value="3"> </span>
                                                <span class="star" data-value="4"> </span>
                                                <span class="star" data-value="5"> </span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="reviewheader" style='width: 700px;'>
                                            <label for="reviewheader_area">
                                                <input class="reviewheader_area" type="text" placeholder="제목을 입력하세요" name="reviewSubject"
                                                       id='reviewheader_area' style='width: 700px; height:40px' maxlength='25'>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label for="review_txt" style='height:300px; margin-bottom:0;'>
                                             <textarea class="summernote" name="review_body" id='review_txt' maxlength='200'
                                                placeholder='  200자 이내로 기재해주세요.'
                                                style='width: 700px; resize:none; height: 300px;'></textarea>
                                                <script>
                                                    document.getElementById("review_txt").addEventListener("focus", () => {
                                                        document.getElementById("review_txt").style.padding = "2px 2px 2px 10px"
                                                        document.getElementById("review_txt").placeholder = '';
                                                    });
                                                    document.getElementById("review_txt").addEventListener("blur", () => {
                                                        document.getElementById("review_txt").style.padding = "2px 2px 2px 10px";
                                                        document.getElementById("review_txt").placeholder = '200자 이내로 기재해주세요.';
                                                    });
                                                </script>
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="add_area" style="padding:0 15px;">
                                                <p class="txt_count"
                                                   style="right:20px; bottom:15px; color:black; font-size:13px; text-align:right">
                                                    <span id="chk_byte">0</span>/<span class="maximum">200</span>
                                                </p>
                                            </div>
                                        </td>
                                    </tr>
                                    <script>
                                        /** 텍스트 영역(textarea) */
                                        let textarea1 = document.querySelector('.summernote');

                                        /** 입력 중인 문자 수 */
                                        let string_num = document.querySelector('#chk_byte');

                                        // 텍스트를 입력할 때마다 onKeyUp()을 실행
                                        textarea1.addEventListener('keyup', onKeyUp);
                                        function onKeyUp() {
                                            // 입력된 텍스트
                                            const inputText = textarea1.value;
                                            // 문자 수를 반영
                                            string_num.innerText = inputText.length;
                                        }
                                    </script>
                                    <tr style='text-align:center;'>
                                        <td class='reviewsub-btn' style='color: #01d28e; '>
                                            <input type="submit" value="등록">
                                            <input type="button" value="닫기" class="close_btn">
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- --Footer start ------------ -->
<div th:insert="~{footer :: footer-fragment}"></div>
<!-- ---------------Footer end ------------ -->

<!--loader -->
<div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
    <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
    <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
            stroke="#F96D00" />
</svg></div>

<script src="/js/jquery.min.js"></script>
<script src="/js/jquery-migrate-3.0.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.easing.1.3.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.stellar.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/aos.js"></script>
<script src="/js/jquery.animateNumber.min.js"></script>
<script src="/js/bootstrap-datepicker.js"></script>
<script src="/js/jquery.timepicker.min.js"></script>
<script src="/js/scrollax.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/custom_ha.js"></script><!--현아언니-->
</body>

</html>